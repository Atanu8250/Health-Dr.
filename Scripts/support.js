
let knowledgeBaseData = [
    {
        question: 'Getting Started',
        answer: [
            {
                heading: 'About Health-Dr. and How It Works',
                anchorTag: [
                    'Intro to Health-Dr.'
                ]
            },

            {
                heading: 'Features to Help Get You Up and Running',
                anchorTag: [
                    'Getting Started with Health-Dr.',
                    'Total Receipe Size and Portion Size',
                    'How to Use the Barcode Scanner',
                    'How to Log Meals in the Lose It! App',
                    'Numbers on the Log Screen',
                    'How to Set a New Weight Goal'
                ],
                button: 'SEE ALL 13 ARTICLES'
            },

            {
                heading: 'Moving from MFP to Lose It!',
                anchorTag: [
                    'How to Master Logging Foods in Lose It!',
                    'The Calorie Bonus',
                    'Creating & Logging Recipes',
                    'Macronutrient Tracking'
                ],
            },
        ]
    },

    {
        question: 'Using Health-Dr.',
        answer: [
            {
                heading: 'My Account',
                anchorTag: [
                    'Different Serving Types on Food',
                    'Editing Your Age, Gender, Height & Activity Level',
                    'Sign in With Apple (SiWA)',
                    'Switch from Apple ID (Sign in with Apple) to Email Address',
                    'How to Download Reports',
                    'How to Contact Lose It! Support'
                ],
                button: 'SEE ALL 20 ARTICLES'
            },

            {
                heading: 'Foods & Exercises',
                anchorTag: [
                    'My Streak Reset',
                    'How to Add a Timestamp',
                    'How to Change the Serving Size Selector',
                    'How to Use the Serving Size Guide',
                    'How To View or Delete from My Foods / Exercises',
                    'Using Exclude From Total'
                ],
                button: 'SEE ALL 33 ARTICLES'
            },

            {
                heading: 'My Weight Loss Plan',
                anchorTag: [
                    'Goal Date Projection and Perfect Weeks',
                    'Personalized Adaptive Budget (Beta)',
                    'Timeline and Achievements',
                    'Milestones',
                    'Fix Incorrect Total Weight Loss'
                ],
                button: 'SEE ALL 23 ARTICLES'
            },

            {
                heading: 'Premium Features',
                anchorTag: [
                    'Editing Intermittent Fasts',
                    'Intermittent Fasting',
                    'How to Delete Goals',
                    'How to Edit Goals',
                    'Progress Photos',
                    'Flexible Budget or Weekender Budget'
                ],
                button: 'SEE ALL 27 ARTICLES'
            },

            {
                heading: 'DNA Insights',
                anchorTag: [
                    'How to Download My DNA Report',
                    'Viewing my Lose It! DNA Insights',
                    'Why Lose It! DNA Insights are Different',
                    'DNA Sequencing Kit',
                    'DNA Sequencing Guide',
                    'Differences in DNA Report with AncestryDNA or 23andMe'
                ]
            },

            {
                heading: 'Other',
                anchorTag: [
                    'Dashboard',
                    'Minimum Software to Run Lose It!',
                    'Android Widgets',
                    'iOS Widgets',
                    'Challenges app',
                    'embodyDNA'
                ],
                button: 'SEE ALL 15 ARTICLES'
            },
        ]
    },

    {
        question: 'Apps & Devices',
        answer: [
            {
                heading: 'Apps & Devices',
                anchorTag: [
                    'Disable Calorie Bonus and/or Exercise Calories',
                    'Amazon Halo',
                    'Calorie Bonus',
                    'How to Connect iOS Health for Steps Tracking',
                    'Using Misfit with Lose It!',
                    'How to Earn a Calorie Bonus With Steps'
                ],
                button: 'SEE ALL 24 ARTICLES'
            }
        ]
    },

    {
        question: 'Social & Community',
        answer: [
            {
                heading: 'Groups',
                anchorTag: [
                    'How to Join a Group',
                    'How to Create a Group',
                    'Invite Friends to Group',
                    'How to Edit a Group',
                    'Groups Tips and Tricks (FAQ)'
                ]
            },

            {
                heading: 'Friends',
                anchorTag: [
                    'Adding Friends',
                    'Remove Friends',
                    'What is Shared with Friends?'
                ]
            },

            {
                heading: 'Sharing',
                anchorTag: [
                    'How to Share my Food Logs with Others',
                    'How to Share Meals',
                    'Share Using Airdrop (iOS only)',
                    'How to Share Custom Foods, Custom Exercises, and Recipes',
                    'Sharing and Exporting Data',
                    'How To Export/Print Daily Or Weekly Logs'
                ]
            },

            {
                heading: 'Notifications',
                anchorTag: [
                    'Messaging',
                    'Notification Center',
                    'Email Notification Settings'
                ]
            },

            {
                heading: 'Social Privacy',
                anchorTag: [
                    'How to Manage your Privacy Settings',
                    'Managing Username, Profile, Personal Details, Custom Data, & Privacy',
                    'Managing Lose It! Profile',
                    'Unsubscribing from Emails'
                ]
            },

            {
                heading: 'Community Saftey',
                anchorTag: [
                    'How to Report a User',
                    'Community Standards',
                    'Community Guidelines & Customer Interaction Standards',
                    'Upvotes and Downvotes in Community'
                ]
            },

            {
                heading: 'Other',
                anchorTag: [
                    'Discover Tab and Content Feed',
                    'Lose It! Legacy Badges',
                    'Sunsetting the Referral Program',
                    'Lose It! Challenges Retired',
                    'Not Getting Welcome Aboard Badge'
                ]
            },
        ]
    },

    {
        question: 'Troubleshooting',
        answer: [
            {
                heading: 'Apps/Devices Troubleshooting',
                anchorTag: [
                    'Garmin: Troubleshooting',
                    'General Apps & Devices Troubleshooting',
                    'Apple Watch: Troubleshooting',
                    'Fitbit: Troubleshooting',
                    'iOS Devices Not Syncing',
                    'How to Fix Data Not Syncing from Health to Lose It!'
                ],
                button: 'SEE ALL 18 ARTICLES'
            },

            {
                heading: 'General Troubleshooting',
                anchorTag: [
                    'Device Not Syncing to Health-Dr.!.com',
                    'How to Fix Barcode Scanner Not Working',
                    "Changed my plan but calorie budget hasn't updated",
                    'Recovering Lost Data',
                    'Calorie budget stuck or not updating',
                    'Why My Weight Keeps Changing'
                ],
                button: 'SEE ALL 8 ARTICLES'
            },

            {
                heading: 'Known Issues/Errors',
                anchorTag: [
                    'Food Search Down',
                    'Friends Feed Not Working',
                    'Database Error 10011 or 10001'
                ]
            }
        ]
    },

    {
        question: 'Managing Privacy',
        answer: [
            {
                heading: 'Privacy',
                anchorTag: [
                    'California Consumer Privacy Act',
                    'Exercising Privacy Policy Rights',
                    'GDPR'
                ]
            }
        ]
    },

    {
        question: 'Feature Requests',
        answer: [
            {
                heading: 'Popular Feature Requests',
                anchorTag: [
                    'Samsung Health Integration',
                    'Meal Suggestions by Diet Type',
                    'Tracking Additional Nutrients',
                    'Change Week Start Date'
                ]
            }
        ]
    }
]

const appendKnowledgeBase = (data) => {
    let container = document.querySelector('#knowledge_base');
    let h1 = document.createElement('h1')
    h1.id = 'headingOfKB';
    h1.innerHTML = 'Knowledge Base'

    container.append(h1);

    data.forEach(({ question, answer }, index) => {
        let div = document.createElement('div');
        div.onclick = () => {
            div.classList.toggle('active');
        }
        div.setAttribute('class', 'faq');
        div.innerHTML = `
        <div class="question">
            <p>${question}</p>
            <span class="material-symbols-outlined">
                expand_more
            </span>
        </div>

        <div class="answer"></div>
        `
        container.append(div);

        let classFaq = document.querySelectorAll('.faq');
        // console.log(classFaq[index].childNodes[3].innerHTML = 'hello');

        let container2 = classFaq[index].childNodes[3];

        answer.forEach(({ heading, anchorTag, button }) => {
            let div = document.createElement('div');

            let p = document.createElement('p');
            p.innerHTML = heading;

            div.append(p);

            for (let a of anchorTag) {
                let anchor = document.createElement('a');
                anchor.href = '#';
                anchor.innerHTML = a;
                div.append(anchor);
            }

            if (button) {
                let btn = document.createElement('button')
                btn.innerHTML = button;
                div.append(btn);
            }

            container2.append(div);
        })

    })
}

appendKnowledgeBase(knowledgeBaseData);

//! =================== Chat box open and close program ===================
let flag = 0;


const openChatBox = () => {
    if (flag) {
        document.querySelector('#message>div:nth-child(2)').style.display = 'none';
        document.querySelector('#chat').style.display = 'flex'
        document.querySelector('#cross').style.display = 'none'

        flag = 0;
    } else {
        document.querySelector('#message>div:nth-child(2)').style.display = 'grid';
        document.querySelector('#chat').style.display = 'none'
        document.querySelector('#cross').style.display = 'flex'

        flag = 1;
    }
}


const doChat = () => {
    let inputBox = document.querySelector('#writeYourThoughts>input');

    let container = document.querySelector('#message>div:nth-child(2)>div:nth-child(2)');

    if (inputBox.value) {
        let chat = document.createElement('div');
        chat.setAttribute('class', 'myChat');
        chat.innerHTML = `
        <p>${inputBox.value}</p>
        `
        container.append(chat);

        inputBox.value = '';


        let roboChat = document.createElement('div');
        roboChat.setAttribute('class', 'roboChat');
        

        roboChat.innerHTML = `
        <div><img src="./images/typing.svg"/></div>
        `
        container.append(roboChat)

        setTimeout(() => {
            roboChat.innerHTML = null;
            roboChat.innerHTML = `
            <p>Thank You for reaching to us, we are trying to solve your issue!</p>
            `
        }, 2000)
    }
}





document.querySelector('#message>div:first-child').onclick = () => { openChatBox() };
document.querySelector('#lookingFor>button').onclick = () => { openChatBox() };
document.querySelector('#logo+button').onclick = () => { openChatBox() };


document.querySelector('#writeYourThoughts>div:last-child').onclick = () => { doChat() }
document.querySelector('#writeYourThoughts>input').onkeypress = (e) => {
    if (e.key == 'Enter') {
        doChat();
    }
}


